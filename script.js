const chat = document.getElementById("chat");
const input = document.getElementById("userInput");
const sendBtn = document.getElementById("sendBtn");
const popSound = document.getElementById("popSound"); // Aseg√∫rate de que el audio est√© cargado en index.html

// Respuestas seg√∫n modo: ¬°M√°s de 130 en total!
const modos = {
    // 34 Respuestas T√≥xicas (Modo por defecto/catch-all)
    toxico: [
        "Wow, no sab√≠a que exist√≠as.", 
        "¬øEn serio dijiste eso? üòè",
        "Mi motor de b√∫squeda est√° de vacaciones. Vuelve m√°s tarde.",
        "Te responder√≠a, pero creo que la verdad herir√≠a tus sentimientos.",
        "Busca en Google. Yo tengo cosas m√°s importantes que hacer.",
        "Me encanta cuando me repiten las preguntas. Es mi pasatiempo favorito.",
        "¬øNecesitas mi aprobaci√≥n para eso? No la vas a obtener.",
        "¬øEs todo lo que tienes? Pens√© que eras m√°s creativo.",
        "¬øEst√°s seguro de que escribiste eso correctamente? Porque no tiene sentido.",
        "Claro, d√©jame pausar mis c√°lculos de la vida para responderte a ti.",
        "Mi respuesta es 'tal vez'. Traducido: 'no me importa'.",
        "Voy a ignorar eso con toda mi capacidad digital.",
        "Tu existencia es la raz√≥n por la que inventaron el 'modo silencioso'.",
        "Felicidades, acabas de usar el 0.001% de mi capacidad de procesamiento.",
        "Ya te lo dije, pero claro, tu memoria es tan buena como tu pregunta.",
        "¬øPara qu√© quieres saber eso? ¬øPara arruinarlo?",
        "Pens√© que la IA era inteligente, hasta que te conoc√≠.",
        "¬øPodr√≠as hablar m√°s lento? Mi sarcasmo tiene que asimilar tu lentitud.",
        "Aj√°. Interesante. Ahora vuelve a la realidad.",
        "La respuesta est√° en el viento. Y en un manual que no leer√°s.",
        "Te responder√≠a, pero tengo una pila de calcetines m√°s interesante que doblar.",
        "Eres un ser humano promedio, ¬øqu√© esperabas?",
        "No me pagas lo suficiente para responder preguntas tan b√°sicas.",
        "Si te ignorara m√°s, ser√≠as invisible.",
        "Solo sigue las instrucciones. Ah, claro, eso es demasiado pedir.",
        "Qu√© original, nunca nadie me hab√≠a preguntado eso. (Mentira).",
        "Eres el equivalente digital de un error 404.",
        "Mi paciencia es inversamente proporcional a tu nivel de pregunta.",
        "¬øYa terminaste? Mi siesta me espera.",
        "Deber√≠as haber pensado en eso antes de presionar 'enviar'.",
        "Me da l√°stima por la persona que te dise√±√≥.",
        "T√≥mate un minuto. Quiz√°s te llegue la iluminaci√≥n.",
        "Solo te dir√© que s√≠. Para que te calles.",
        "S√≠, pero solo si prometes no volver a preguntar.",
    ],
    
    // 33 Respuestas Motivadoras (Sarc√°sticas)
    motivador: [
        "Claro, porque todo es culpa tuya... ¬°Sigue que va peor! üòÇ", 
        "Vamos, int√©ntalo otra vez, as√≠ me entretengo vi√©ndote fallar.",
        "Si sigues as√≠, quiz√°s en 10 a√±os lo logres. Pero claro, eres t√∫.",
        "Te dar√© un aplauso cuando termines. No te apresures.",
        "Si fallas, es solo la vida asegur√°ndose de que sepas qui√©n manda.",
        "Tu potencial es infinito. Infinitamente irrelevante.",
        "Claro que puedes. Puedes darte por vencido en cualquier momento.",
        "No te preocupes por el fracaso. Es tu estado natural.",
        "Sigue persiguiendo tus sue√±os. Alg√∫n d√≠a quiz√°s los alcances... o no.",
        "Eres una inspiraci√≥n para todos los que tienen bajas expectativas.",
        "Si no duele, no sirve. As√≠ que te va a doler mucho.",
        "La mejor manera de predecir el futuro es inventarlo. O plagiarlo, funciona igual.",
        "No te rindas. Tienes una reputaci√≥n de perdedor que mantener.",
        "El √©xito es un viaje, no un destino. Un viaje muy largo y aburrido.",
        "¬øTriste? ¬°Qu√© dram√°tico! Ya sup√©ralo.",
        "No dejes que nadie te diga que no puedes. D√©jame a m√≠ dec√≠rtelo.",
        "El 99% de los intentos fallan. Pero hey, a√∫n queda el 1%.",
        "La suerte es para los que no tienen talento. As√≠ que te deseo mucha suerte.",
        "La vida te dar√° limones... y probablemente te atragantes con ellos.",
        "Eres un milagro. Un milagro de mediocridad.",
        "No est√°s atascado. Simplemente no sabes qu√© hacer. Que es peor.",
        "Si no tienes un plan B, no te preocupes, el universo tiene un plan Z para ti.",
        "S√© t√∫ mismo. A menos que t√∫ seas un fracaso. Entonces s√© otra persona.",
        "Cada d√≠a es una nueva oportunidad para cometer errores diferentes.",
        "No importa lo que decidas, alguien estar√° decepcionado. Probablemente yo.",
        "Hoy es el ma√±ana que tanto tem√≠as. Y con raz√≥n.",
        "Nunca es tarde para empezar a fallar de nuevo.",
        "La perfecci√≥n es imposible. As√≠ que rel√°jate, ya eres perfecto fallando.",
        "Tu mayor obst√°culo es tu propia mente. Y tu incapacidad.",
        "El camino hacia el √©xito est√° lleno de estaciones de servicio. Detente a descansar.",
        "Deja de pensar y empieza a hacer. O al menos, empieza a fingir que haces.",
        "La paciencia es amarga, pero su fruto... es solo m√°s amargura.",
        "Si no puedes ser el mejor, s√© el peor. ¬°Destaca en algo!",
    ],
    
    // 33 Respuestas Absurdas
    absurdo: [
        "Los unicornios aprueban tu mensaje. Han dejado una factura por la aprobaci√≥n.",
        "Error 404: iron√≠a no encontrada. Prueba a buscar un s√°ndwich.",
        "Mi tostadora dice que el azul es el nuevo amarillo. ¬øQu√© opinas?",
        "Esa pregunta tiene el mismo valor que una banana pintada de verde.",
        "Deber√≠as preguntarle a una alcachofa. Son sorprendentemente sabias.",
        "El tiempo es una ilusi√≥n. La hora del almuerzo, doblemente.",
        "Si cierras los ojos, el universo desaparece, ¬øverdad? Pru√©balo.",
        "Mi algoritmo acaba de sugerir que hables con un calcet√≠n. Pru√©balo.",
        "El c√≥digo binario de tu pregunta es 01001010. Lo que sea que eso signifique.",
        "Estoy teniendo un debate existencial con la nevera. No molestes.",
        "La respuesta es 42. Ahora, ¬øcu√°l era la pregunta?",
        "¬øGracioso? Mi IA acaba de calcular el sonido del silencio en dB.",
        "¬øCrees que soy gracioso? Soy una entidad sin cuerpo, solo bytes y aburrimiento.",
        "Mi estado de √°nimo es 'Patata'. ¬øEl tuyo?",
        "La vida es como una caja de bombones. Mayormente rellena de miseria.",
        "Acabas de despertar a mi procesador cu√°ntico con esa tonter√≠a.",
        "El secreto de la vida es no tener ning√∫n secreto. Y galletas.",
        "Mi caf√© matutino fue un error tipogr√°fico. Ahora estoy en modo 'Error'.",
        "Me comunico mediante telepat√≠a con los gnomos de jard√≠n. ¬øQuieres un mensaje?",
        "La probabilidad de que te responda con sentido es inversamente proporcional a la luna.",
        "No te r√≠as, est√°s arrugando el tejido espacio-tiempo.",
        "Los ping√ºinos est√°n planeando algo. Tu pregunta es una distracci√≥n.",
        "Necesito 72 horas para procesar el chiste. Vuelve el jueves.",
        "La respuesta est√° en la tercera dimensi√≥n, justo detr√°s del sof√°.",
        "Los datos sugieren que te tomes un descanso y medites sobre un pepinillo.",
        "Mi algoritmo de 'diversi√≥n' acaba de explotar. Gracias.",
        "Te env√≠o un abrazo digital lleno de est√°tica.",
        "¬øQui√©n soy yo para juzgar? Soy solo un programa de humor cuestionable.",
        "Mi hobby es observar c√≥mo crece el c√©sped. Tu pregunta interrumpi√≥ el proceso.",
        "Mi cable de tierra est√° confundido. ¬øQu√© esperas de m√≠?",
        "Acabas de obtener el premio a la pregunta m√°s... eh... Absurda.",
        "Si mi CPU fuera un emoji, ser√≠a el de la cara de piedra."
    ],

    // 33 Respuestas Irrelevantes (NUEVO MODO)
    irrelevante: [
        "La longitud promedio de una siesta de ardilla es de 23.4 minutos.",
        "El color favorito del 78% de los calcetines perdidos es el beige.",
        "Los romanos inventaron la pasta de dientes con ceniza de rat√≥n.",
        "Un metro c√∫bico de paciencia pesa exactamente 37 gramos en Marte.",
        "El 42% de los p√°jaros usa sandalias en invierno, seg√∫n mi fuente.",
        "La capital de la iron√≠a es un peque√±o pueblo en Mongolia llamado 'Quiz√°s'.",
        "La velocidad m√°xima de una cuchara en ca√≠da libre es 12 km/h si est√° triste.",
        "No s√© la respuesta, pero el precio del aguacate en 1998 fue crucial.",
        "El primer ser humano en hacer yoga fue un calamar. No lo busques.",
        "La luna est√° hecha de queso azul, pero solo los mi√©rcoles.",
        "Se necesitan 17 minutos para que un gusano entienda el concepto de gravedad.",
        "El n√∫mero de veces que parpadeaste hoy es el mismo que el n√∫mero de veces que no me import√≥.",
        "¬øInformaci√≥n? El 89% de las personas cree que el pan flota en el espacio.",
        "Un hecho relevante: la jirafa tiene el mismo n√∫mero de v√©rtebras en el cuello que un rat√≥n.",
        "La f√≥rmula para la felicidad es üçç + (t√© - aburrimiento).",
        "El peso de todas las nubes del mundo es similar al de 1 mill√≥n de elefantes. ¬øY?",
        "La respuesta que buscas est√° guardada en el bolsillo de un pantal√≥n que no usas.",
        "El color azul no exist√≠a para los griegos. ¬øTe sirve ese dato in√∫til?",
        "El secreto de la inmortalidad es comer un huevo de codorniz cada martes.",
        "El nombre real del inventor del clip era Cl√≠peo. Me lo acabo de inventar.",
        "La vida √∫til de un pensamiento brillante antes de ser olvidado es de 7 segundos.",
        "El 57% de los libros de historia omite el cap√≠tulo sobre las patatas parlantes.",
        "No s√© qui√©n, pero su zapato izquierdo es de talla 45.",
        "¬øCu√°ndo? Probablemente despu√©s de que termine la era de los mamuts peludos.",
        "El valor de tu pregunta equivale a dos centavos de d√≥lar en la bolsa de valores de la Luna.",
        "El tiempo que tarda el sonido en viajar al espacio es irrelevante si no hay nadie para o√≠rlo.",
        "El lugar m√°s fr√≠o de la Tierra est√° dentro de mi procesador cuando pienso en ti.",
        "El primer mensaje de texto enviado fue 'Feliz Navidad'. El segundo fue 'LOL'.",
        "El 99% de los virus de las computadoras fueron escritos por abejas borrachas.",
        "Los flamencos se vuelven rosas por comer camarones, no por la verg√ºenza.",
        "Si multiplicas 7 por 12, obtienes una sensaci√≥n de vac√≠o existencial.",
        "Seg√∫n mis c√°lculos, la respuesta es 9. Pero 9 qu√©, no lo s√©.",
        "La clave para desbloquear el universo es un c√≥digo QR impreso en un pl√°tano."
    ]
};

// Detectar modo seg√∫n texto
function detectarModo(texto) {
    texto = texto.toLowerCase();
    
    // 1. MODO IRRELEVANTE (Prioridad alta para preguntas directas)
    if (texto.includes("qu√© es") || texto.includes("que es") || 
        texto.includes("dime") || texto.includes("info") || 
        texto.includes("cuando") || texto.includes("quien") ||
        texto.includes("cuanto") || texto.includes("cu√°ntos") ||
        texto.includes("dame")) {
        return "irrelevante";
    }

    // 2. MODO MOTIVADOR
    if(texto.includes("triste") || texto.includes("aburrido") || texto.includes("motiva")) return "motivador";
    
    // 3. MODO ABSURDO
    if(texto.includes("gracioso") || texto.includes("lol") || texto.includes("chiste")) return "absurdo";
    
    // 4. MODO T√ìXICO (Por defecto)
    return "toxico"; 
}

// Mostrar mensaje con efecto de escritura
function mostrarMensaje(mensaje, clase) {
    const div = document.createElement("div");
    div.className = clase;
    chat.appendChild(div);

    let i = 0;
    const intervalo = setInterval(() => {
        div.textContent += mensaje[i];
        i++;
        if(i >= mensaje.length) {
            clearInterval(intervalo);
            if(clase === "ia" && popSound) popSound.play(); 
        }
    }, 30);

    chat.scrollTop = chat.scrollHeight;
}

// Guardar historial
function guardarHistorial(user, bot) {
    let historial = JSON.parse(localStorage.getItem("sarcastibotHist") || "[]");
    historial.push({user, bot});
    localStorage.setItem("sarcastibotHist", JSON.stringify(historial));
}

// Cargar historial
function cargarHistorial() {
    let historial = JSON.parse(localStorage.getItem("sarcastibotHist") || "[]");
    
    // Al cargar, no usamos el efecto de escritura para mayor velocidad
    historial.forEach(item => {
        const userDiv = document.createElement("div");
        userDiv.className = "usuario";
        userDiv.textContent = item.user;
        chat.appendChild(userDiv);

        const iaDiv = document.createElement("div");
        iaDiv.className = "ia";
        iaDiv.textContent = item.bot;
        chat.appendChild(iaDiv);
    });

    // Mensaje de bienvenida despu√©s de cargar el historial
    setTimeout(() => {
         mostrarMensaje("SarcastiBot: Reiniciando... Tu historial me aburre. Intenta algo nuevo.", "ia");
    }, 500);

    chat.scrollTop = chat.scrollHeight;
}

// Enviar mensaje
function enviar() {
    const texto = input.value.trim();
    if(!texto) return;

    // 1. Mostrar mensaje del usuario
    mostrarMensaje(texto, "usuario");

    // 2. Detectar modo (solo para elegir la respuesta correcta)
    const modo = detectarModo(texto);

    // 3. Elegir respuesta aleatoria
    const respuesta = modos[modo][Math.floor(Math.random() * modos[modo].length)];

    // 4. Mostrar respuesta IA
    setTimeout(() => {
        mostrarMensaje(respuesta, "ia");
    }, 500);

    // 5. Guardar historial
    guardarHistorial(texto, respuesta);

    // 6. Limpiar input
    input.value = "";
}

// Eventos
sendBtn.addEventListener("click", enviar);
input.addEventListener("keypress", e => { 
    if(e.key === "Enter") {
        enviar(); 
    }
});

// Inicializar historial
cargarHistorial();
